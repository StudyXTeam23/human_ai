===============================================================
        ğŸ¯ æœ€ç»ˆéƒ¨ç½²é…ç½®æ€»ç»“
===============================================================

âœ… é…ç½®å®Œæˆé¡¹:

1. ç«¯å£é…ç½® âœ…
   å‰ç«¯ç«¯å£: 18200
   åç«¯ç«¯å£: 18201

2. é¡¹ç›®è·¯å¾„ âœ…
   æœåŠ¡å™¨è·¯å¾„: /root/home/yuyuan/studyx_human

3. æƒé™é…ç½® âœ…
   è¿è¡Œç”¨æˆ·: root
   è¿è¡Œç»„: root

===============================================================

ğŸ“‚ å®Œæ•´è·¯å¾„ç»“æ„:

/root/home/yuyuan/studyx_human/
â”œâ”€â”€ web/
â”‚   â”œâ”€â”€ backend/                        # åç«¯ç›®å½•
â”‚   â”‚   â”œâ”€â”€ app/                        # FastAPI åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ venv/                       # Python è™šæ‹Ÿç¯å¢ƒ
â”‚   â”‚   â”œâ”€â”€ uploads/                    # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ .env                        # ç¯å¢ƒå˜é‡ (éœ€è¦é…ç½®)
â”‚   â”‚   â”œâ”€â”€ requirements-prod.txt       # ç”Ÿäº§ä¾èµ–
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ frontend/                       # å‰ç«¯ç›®å½•
â”‚       â”œâ”€â”€ app/                        # Next.js åº”ç”¨
â”‚       â”œâ”€â”€ .next/                      # æ„å»ºè¾“å‡º
â”‚       â”œâ”€â”€ .env.production             # ç”Ÿäº§ç¯å¢ƒå˜é‡ (éœ€è¦é…ç½®)
â”‚       â””â”€â”€ ...
â””â”€â”€ deploy-scripts/                     # éƒ¨ç½²è„šæœ¬
    â”œâ”€â”€ setup-server.sh                 # æœåŠ¡å™¨ç¯å¢ƒé…ç½®
    â”œâ”€â”€ deploy-backend.sh               # åç«¯éƒ¨ç½²
    â”œâ”€â”€ deploy-frontend.sh              # å‰ç«¯éƒ¨ç½²
    â””â”€â”€ setup-nginx.sh                  # Nginx é…ç½®

===============================================================

ğŸš€ å®Œæ•´éƒ¨ç½²æµç¨‹:

æ­¥éª¤ 1: ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨
-----------------------
# æœ¬åœ°æ‰“åŒ… (æ’é™¤ä¸å¿…è¦çš„æ–‡ä»¶)
cd /Users/yuyuan/studyx_human
tar -czf studyx.tar.gz \
  --exclude='node_modules' \
  --exclude='venv' \
  --exclude='.next' \
  --exclude='__pycache__' \
  --exclude='.git' \
  --exclude='uploads' \
  .

# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp studyx.tar.gz root@your-server-ip:/root/home/yuyuan/

# SSH åˆ°æœåŠ¡å™¨
ssh root@your-server-ip

# åˆ›å»ºç›®å½•å¹¶è§£å‹
mkdir -p /root/home/yuyuan/studyx_human
cd /root/home/yuyuan
tar -xzf studyx.tar.gz -C studyx_human/
rm studyx.tar.gz

æ­¥éª¤ 2: é…ç½®æœåŠ¡å™¨ç¯å¢ƒ (é¦–æ¬¡éƒ¨ç½²)
-----------------------
cd /root/home/yuyuan/studyx_human
bash deploy-scripts/setup-server.sh

# è¿™ä¸ªè„šæœ¬ä¼šå®‰è£…:
# - Python 3.11
# - Node.js 18
# - pnpm
# - PM2
# - Nginx
# - Certbot
# - é…ç½®é˜²ç«å¢™

æ­¥éª¤ 3: é…ç½®ç¯å¢ƒå˜é‡
-----------------------
# åç«¯ç¯å¢ƒå˜é‡
vim /root/home/yuyuan/studyx_human/web/backend/.env

# å¿…å¡«å†…å®¹:
OPENAI_API_KEY=sk-your-actual-key-here
CORS_ORIGINS=http://localhost:18200,https://yourdomain.com
HTTP_PROXY=
HTTPS_PROXY=

# å‰ç«¯ç¯å¢ƒå˜é‡
vim /root/home/yuyuan/studyx_human/web/frontend/.env.production

# å†…å®¹:
NEXT_PUBLIC_API_URL=https://api.yourdomain.com

æ­¥éª¤ 4: éƒ¨ç½²åç«¯
-----------------------
cd /root/home/yuyuan/studyx_human
bash deploy-scripts/deploy-backend.sh

# è¿™ä¸ªè„šæœ¬ä¼š:
# - åˆ›å»º Python è™šæ‹Ÿç¯å¢ƒ
# - å®‰è£…ä¾èµ–
# - é…ç½® Systemd æœåŠ¡
# - å¯åŠ¨åç«¯æœåŠ¡ (ç«¯å£ 18201)

æ­¥éª¤ 5: éƒ¨ç½²å‰ç«¯
-----------------------
cd /root/home/yuyuan/studyx_human
bash deploy-scripts/deploy-frontend.sh

# è¿™ä¸ªè„šæœ¬ä¼š:
# - å®‰è£… Node.js ä¾èµ–
# - æ„å»ºç”Ÿäº§ç‰ˆæœ¬
# - ä½¿ç”¨ PM2 å¯åŠ¨å‰ç«¯ (ç«¯å£ 18200)

æ­¥éª¤ 6: é…ç½® Nginx
-----------------------
bash deploy-scripts/setup-nginx.sh

# è¾“å…¥ä½ çš„åŸŸå:
# - ä¸»åŸŸå: yourdomain.com
# - API åŸŸå: api.yourdomain.com

# è¿™ä¸ªè„šæœ¬ä¼š:
# - åˆ›å»º Nginx é…ç½®
# - é…ç½®åå‘ä»£ç†
# - é‡å¯ Nginx

æ­¥éª¤ 7: é…ç½® DNS
-----------------------
# åœ¨åŸŸåæœåŠ¡å•†æ·»åŠ  A è®°å½•:
yourdomain.com      A    æœåŠ¡å™¨IP
www.yourdomain.com  A    æœåŠ¡å™¨IP
api.yourdomain.com  A    æœåŠ¡å™¨IP

æ­¥éª¤ 8: ç”³è¯· SSL è¯ä¹¦
-----------------------
# ä½¿ç”¨ Let's Encrypt å…è´¹è¯ä¹¦
sudo certbot --nginx -d yourdomain.com -d www.yourdomain.com
sudo certbot --nginx -d api.yourdomain.com

# è‡ªåŠ¨ç»­æœŸå·²é…ç½®,æ— éœ€æ‰‹åŠ¨æ“ä½œ

===============================================================

ğŸ”§ Systemd æœåŠ¡é…ç½®è¯¦æƒ…:

æœåŠ¡æ–‡ä»¶: /etc/systemd/system/ai-humanizer-api.service

[Unit]
Description=AI Text Humanizer API
After=network.target

[Service]
Type=notify
User=root                              # ä½¿ç”¨ root ç”¨æˆ·
Group=root                             # ä½¿ç”¨ root ç»„
WorkingDirectory=/root/home/yuyuan/studyx_human/web/backend
Environment="PATH=/root/home/yuyuan/studyx_human/web/backend/venv/bin"
EnvironmentFile=/root/home/yuyuan/studyx_human/web/backend/.env
ExecStart=/root/home/yuyuan/studyx_human/web/backend/venv/bin/gunicorn \
    app.main:app \
    --workers 4 \
    --worker-class uvicorn.workers.UvicornWorker \
    --bind 0.0.0.0:18201 \
    --timeout 120 \
    --access-logfile /var/log/ai-humanizer/access.log \
    --error-logfile /var/log/ai-humanizer/error.log
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target

===============================================================

ğŸŒ Nginx é…ç½®è¯¦æƒ…:

é…ç½®æ–‡ä»¶: /etc/nginx/sites-available/ai-humanizer

upstream backend_api {
    server 127.0.0.1:18201;           # åç«¯ç«¯å£
}

upstream frontend_web {
    server 127.0.0.1:18200;           # å‰ç«¯ç«¯å£
}

server {
    listen 80;
    server_name yourdomain.com www.yourdomain.com;
    
    location / {
        proxy_pass http://frontend_web;
        # ... proxy headers
    }
}

server {
    listen 80;
    server_name api.yourdomain.com;
    
    client_max_body_size 50M;         # æ–‡ä»¶ä¸Šä¼ é™åˆ¶
    
    location / {
        proxy_pass http://backend_api;
        # ... proxy headers
    }
}

===============================================================

ğŸ› ï¸ æœåŠ¡ç®¡ç†å‘½ä»¤:

åç«¯æœåŠ¡ (Systemd):
  sudo systemctl start ai-humanizer-api      # å¯åŠ¨
  sudo systemctl stop ai-humanizer-api       # åœæ­¢
  sudo systemctl restart ai-humanizer-api    # é‡å¯
  sudo systemctl status ai-humanizer-api     # çŠ¶æ€
  sudo systemctl enable ai-humanizer-api     # å¼€æœºè‡ªå¯
  sudo journalctl -u ai-humanizer-api -f     # æŸ¥çœ‹æ—¥å¿—

å‰ç«¯æœåŠ¡ (PM2):
  pm2 start ai-humanizer-web                 # å¯åŠ¨
  pm2 stop ai-humanizer-web                  # åœæ­¢
  pm2 restart ai-humanizer-web               # é‡å¯
  pm2 status                                 # çŠ¶æ€
  pm2 logs ai-humanizer-web                  # æŸ¥çœ‹æ—¥å¿—
  pm2 save                                   # ä¿å­˜é…ç½®
  pm2 startup                                # å¼€æœºè‡ªå¯

Nginx:
  sudo systemctl start nginx                 # å¯åŠ¨
  sudo systemctl stop nginx                  # åœæ­¢
  sudo systemctl restart nginx               # é‡å¯
  sudo systemctl status nginx                # çŠ¶æ€
  sudo nginx -t                              # æµ‹è¯•é…ç½®

===============================================================

ï¿½ï¿½ æµ‹è¯•å’ŒéªŒè¯:

1. æµ‹è¯•åç«¯å¥åº·æ£€æŸ¥
   curl http://localhost:18201/health
   # é¢„æœŸè¾“å‡º: {"status":"healthy","version":"1.0.0"}

2. æµ‹è¯•å‰ç«¯
   curl http://localhost:18200
   # é¢„æœŸè¾“å‡º: HTML å†…å®¹

3. æµ‹è¯•é€šè¿‡åŸŸåè®¿é—®
   curl https://api.yourdomain.com/health
   curl https://yourdomain.com

4. æµè§ˆå™¨æµ‹è¯•
   https://yourdomain.com                    # ä¸»ç«™
   https://api.yourdomain.com/docs           # API æ–‡æ¡£

5. åŠŸèƒ½æµ‹è¯•
   - è¾“å…¥æ–‡æœ¬ (300-5000 å­—ç¬¦)
   - ç‚¹å‡» "Humanize" æŒ‰é’®
   - æŸ¥çœ‹å¤„ç†ç»“æœ
   - ä¸Šä¼ æ–‡æ¡£æµ‹è¯•
   - æŸ¥çœ‹å†å²è®°å½•

===============================================================

ğŸ“Š æœåŠ¡æ¶æ„:

Internet (ç”¨æˆ·)
    â†“
Nginx (80/443) â† SSL ç»ˆæ­¢
    â”œâ”€â”€ yourdomain.com â†’ Next.js (18200) [PM2]
    â””â”€â”€ api.yourdomain.com â†’ FastAPI (18201) [Systemd]
                                â†“
                            OpenAI API

å†…éƒ¨é€šä¿¡:
  å‰ç«¯ (18200) â†’ åç«¯ (18201) â†’ OpenAI API

å¤–éƒ¨è®¿é—®:
  ç”¨æˆ· â†’ Nginx (443) â†’ å‰ç«¯/åç«¯ (18200/18201)

===============================================================

ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•:

ç¯å¢ƒå‡†å¤‡:
  [âœ…] Python 3.11 å·²å®‰è£…
  [âœ…] Node.js 18 å·²å®‰è£…
  [âœ…] pnpm å·²å®‰è£…
  [âœ…] PM2 å·²å®‰è£…
  [âœ…] Nginx å·²å®‰è£…
  [âœ…] Certbot å·²å®‰è£…
  [âœ…] é˜²ç«å¢™å·²é…ç½® (80, 443)

é¡¹ç›®ä¸Šä¼ :
  [ ] é¡¹ç›®å·²ä¸Šä¼ åˆ° /root/home/yuyuan/studyx_human
  [ ] ç›®å½•æƒé™æ­£ç¡® (root:root)

åç«¯é…ç½®:
  [ ] .env æ–‡ä»¶å·²åˆ›å»º
  [ ] OPENAI_API_KEY å·²é…ç½®
  [ ] CORS_ORIGINS å·²é…ç½®
  [ ] è™šæ‹Ÿç¯å¢ƒå·²åˆ›å»º
  [ ] ä¾èµ–å·²å®‰è£…
  [ ] Systemd æœåŠ¡å·²é…ç½®
  [ ] æœåŠ¡å·²å¯åŠ¨ (systemctl status)
  [ ] å¥åº·æ£€æŸ¥é€šè¿‡ (curl localhost:18201/health)

å‰ç«¯é…ç½®:
  [ ] .env.production å·²åˆ›å»º
  [ ] NEXT_PUBLIC_API_URL å·²é…ç½®
  [ ] ä¾èµ–å·²å®‰è£…
  [ ] ç”Ÿäº§ç‰ˆæœ¬å·²æ„å»º
  [ ] PM2 å·²å¯åŠ¨
  [ ] å¼€æœºè‡ªå¯å·²é…ç½®
  [ ] å‰ç«¯å¯è®¿é—® (curl localhost:18200)

Nginx é…ç½®:
  [ ] é…ç½®æ–‡ä»¶å·²åˆ›å»º
  [ ] è™šæ‹Ÿä¸»æœºå·²å¯ç”¨
  [ ] é…ç½®æµ‹è¯•é€šè¿‡ (nginx -t)
  [ ] Nginx å·²é‡å¯

DNS å’Œ SSL:
  [ ] DNS A è®°å½•å·²æ·»åŠ 
  [ ] DNS è§£æç”Ÿæ•ˆ
  [ ] SSL è¯ä¹¦å·²ç”³è¯·
  [ ] HTTPS å¯è®¿é—®
  [ ] HTTP è‡ªåŠ¨è·³è½¬ HTTPS

æœ€ç»ˆæµ‹è¯•:
  [ ] API å¥åº·æ£€æŸ¥é€šè¿‡
  [ ] ä¸»é¡µå¯è®¿é—®
  [ ] æ–‡æœ¬å¤„ç†åŠŸèƒ½æ­£å¸¸
  [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸
  [ ] ç»“æœé¡µæ˜¾ç¤ºæ­£å¸¸
  [ ] å†å²è®°å½•åŠŸèƒ½æ­£å¸¸

===============================================================

ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥:

1. åç«¯å¯åŠ¨å¤±è´¥
   â†’ sudo journalctl -u ai-humanizer-api -n 100
   â†’ æ£€æŸ¥ .env é…ç½®
   â†’ æ£€æŸ¥ Python è™šæ‹Ÿç¯å¢ƒ
   â†’ æ£€æŸ¥ç«¯å£å ç”¨: lsof -i :18201

2. å‰ç«¯æ— æ³•è®¿é—®
   â†’ pm2 logs ai-humanizer-web --lines 100
   â†’ æ£€æŸ¥æ„å»ºæ–‡ä»¶: ls -la .next/
   â†’ æ£€æŸ¥ç«¯å£: lsof -i :18200

3. Nginx 502 é”™è¯¯
   â†’ sudo tail -f /var/log/nginx/error.log
   â†’ æ£€æŸ¥åç«¯/å‰ç«¯æ˜¯å¦è¿è¡Œ
   â†’ æ£€æŸ¥ç«¯å£é…ç½®

4. æ— æ³•è¿æ¥ OpenAI API
   â†’ æ£€æŸ¥ API Key
   â†’ æµ‹è¯•ç½‘ç»œ: curl -I https://api.openai.com
   â†’ ç¡®ä¿ä»£ç†ä¸ºç©º (æœåŠ¡å™¨ä¸éœ€è¦ä»£ç†)

5. æƒé™é”™è¯¯
   â†’ ç¡®è®¤æœåŠ¡ä»¥ root ç”¨æˆ·è¿è¡Œ
   â†’ æ£€æŸ¥ç›®å½•æƒé™: ls -la /root/home/yuyuan/
   â†’ æ£€æŸ¥æ—¥å¿—æƒé™: ls -la /var/log/ai-humanizer/

===============================================================

ğŸ“š ç›¸å…³æ–‡æ¡£ç´¢å¼•:

- å®Œæ•´éƒ¨ç½²æŒ‡å—: DEPLOY_TO_LINUX.md
- å¿«é€Ÿéƒ¨ç½²å‚è€ƒ: QUICK_DEPLOY.txt
- éƒ¨ç½²æ€»ç»“: DEPLOYMENT_SUMMARY.txt
- ç«¯å£é…ç½®è¯´æ˜: PORT_CHANGES_SUMMARY.txt
- è·¯å¾„æ›´æ–°è¯´æ˜: SERVER_PATH_UPDATE.txt
- æœ€ç»ˆé…ç½®æ€»ç»“: FINAL_DEPLOYMENT_CONFIG.txt (æœ¬æ–‡ä»¶)

===============================================================

âœ… é…ç½®å®Œæˆ!

é¡¹ç›®è·¯å¾„: /root/home/yuyuan/studyx_human
å‰ç«¯ç«¯å£: 18200
åç«¯ç«¯å£: 18201
è¿è¡Œç”¨æˆ·: root

å‡†å¤‡å¥½éƒ¨ç½²äº†! ğŸ‰

===============================================================
